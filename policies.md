# Policies

Analysis about the policies and policy sets used by the standard configuration of the module.

## Custom policies

124 custom policies:

1. Append-AppService-httpsonly
1. Append-AppService-latestTLS
1. Append-KV-SoftDelete
1. Append-Redis-disableNonSslPort
1. Append-Redis-sslEnforcement
1. Audit-AzureHybridBenefit
1. Audit-Disks-UnusedResourcesCostOptimization
1. Audit-MachineLearning-PrivateEndpointId
1. Audit-PrivateLinkDnsZones
1. Audit-PublicIpAddresses-UnusedResourcesCostOptimization
1. Audit-ServerFarms-UnusedResourcesCostOptimization
1. Deny-AA-child-resources
1. Deny-AppGW-Without-WAF
1. Deny-AppServiceApiApp-http
1. Deny-AppServiceFunctionApp-http
1. Deny-AppServiceWebApp-http
1. Deny-Databricks-NoPublicIp
1. Deny-Databricks-Sku
1. Deny-Databricks-VirtualNetwork
1. Deny-FileServices-InsecureAuth
1. Deny-FileServices-InsecureKerberos
1. Deny-FileServices-InsecureSmbChannel
1. Deny-FileServices-InsecureSmbVersions
1. Deny-MachineLearning-Aks
1. Deny-MachineLearning-Compute-SubnetId
1. Deny-MachineLearning-Compute-VmSize
1. Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess
1. Deny-MachineLearning-ComputeCluster-Scale
1. Deny-MachineLearning-HbiWorkspace
1. Deny-MachineLearning-PublicAccessWhenBehindVnet
1. Deny-MachineLearning-PublicNetworkAccess
1. Deny-MgmtPorts-From-Internet
1. Deny-MySql-http
1. Deny-PostgreSql-http
1. Deny-Private-DNS-Zones
1. Deny-PublicEndpoint-MariaDB
1. Deny-PublicIP
1. Deny-RDP-From-Internet
1. Deny-Redis-http
1. Deny-Sql-minTLS
1. Deny-SqlMi-minTLS
1. Deny-Storage-SFTP
1. Deny-Storage-minTLS
1. Deny-StorageAccount-CustomDomain
1. Deny-Subnet-Without-Nsg
1. Deny-Subnet-Without-Penp
1. Deny-Subnet-Without-Udr
1. Deny-UDR-With-Specific-NextHop
1. Deny-VNET-Peer-Cross-Sub
1. Deny-VNET-Peering-To-Non-Approved-VNETs
1. Deny-VNet-Peering
1. Deploy-ASC-SecurityContacts
1. Deploy-Budget
1. Deploy-Custom-Route-Table
1. Deploy-DDoSProtection
1. Deploy-Diagnostics-AA
1. Deploy-Diagnostics-ACI
1. Deploy-Diagnostics-ACR
1. Deploy-Diagnostics-APIMgmt
1. Deploy-Diagnostics-AVDScalingPlans
1. Deploy-Diagnostics-AnalysisService
1. Deploy-Diagnostics-ApiForFHIR
1. Deploy-Diagnostics-ApplicationGateway
1. Deploy-Diagnostics-Bastion
1. Deploy-Diagnostics-CDNEndpoints
1. Deploy-Diagnostics-CognitiveServices
1. Deploy-Diagnostics-CosmosDB
1. Deploy-Diagnostics-DLAnalytics
1. Deploy-Diagnostics-DataExplorerCluster
1. Deploy-Diagnostics-DataFactory
1. Deploy-Diagnostics-Databricks
1. Deploy-Diagnostics-EventGridSub
1. Deploy-Diagnostics-EventGridSystemTopic
1. Deploy-Diagnostics-EventGridTopic
1. Deploy-Diagnostics-ExpressRoute
1. Deploy-Diagnostics-Firewall
1. Deploy-Diagnostics-FrontDoor
1. Deploy-Diagnostics-Function
1. Deploy-Diagnostics-HDInsight
1. Deploy-Diagnostics-LoadBalancer
1. Deploy-Diagnostics-LogAnalytics
1. Deploy-Diagnostics-LogicAppsISE
1. Deploy-Diagnostics-MariaDB
1. Deploy-Diagnostics-MediaService
1. Deploy-Diagnostics-MlWorkspace
1. Deploy-Diagnostics-MySQL
1. Deploy-Diagnostics-NIC
1. Deploy-Diagnostics-NetworkSecurityGroups
1. Deploy-Diagnostics-PostgreSQL
1. Deploy-Diagnostics-PowerBIEmbedded
1. Deploy-Diagnostics-RedisCache
1. Deploy-Diagnostics-Relay
1. Deploy-Diagnostics-SQLElasticPools
1. Deploy-Diagnostics-SQLMI
1. Deploy-Diagnostics-SignalR
1. Deploy-Diagnostics-TimeSeriesInsights
1. Deploy-Diagnostics-TrafficManager
1. Deploy-Diagnostics-VM
1. Deploy-Diagnostics-VMSS
1. Deploy-Diagnostics-VNetGW
1. Deploy-Diagnostics-VWanS2SVPNGW
1. Deploy-Diagnostics-VirtualNetwork
1. Deploy-Diagnostics-WVDAppGroup
1. Deploy-Diagnostics-WVDHostPools
1. Deploy-Diagnostics-WVDWorkspace
1. Deploy-Diagnostics-WebServerFarm
1. Deploy-Diagnostics-Website
1. Deploy-Diagnostics-iotHub
1. Deploy-FirewallPolicy
1. Deploy-MySQL-sslEnforcement
1. Deploy-Nsg-FlowLogs
1. Deploy-Nsg-FlowLogs-to-LA
1. Deploy-PostgreSQL-sslEnforcement
1. Deploy-SQL-minTLS
1. Deploy-Sql-AuditingSettings
1. Deploy-Sql-SecurityAlertPolicies
1. Deploy-Sql-Tde
1. Deploy-Sql-vulnerabilityAssessments
1. Deploy-Sql-vulnerabilityAssessments_20230706
1. Deploy-SqlMi-minTLS
1. Deploy-Storage-sslEnforcement
1. Deploy-VNET-HubSpoke
1. Deploy-Vm-autoShutdown
1. Deploy-Windows-DomainJoin

## Policy sets

### Custom policies in no policy set

43 custom policies are not referenced in any policy set:

1. Append-KV-SoftDelete
1. Audit-MachineLearning-PrivateEndpointId
1. Audit-PrivateLinkDnsZones
1. Deny-AA-child-resources
1. Deny-AppGW-Without-WAF
1. Deny-Databricks-NoPublicIp
1. Deny-Databricks-Sku
1. Deny-Databricks-VirtualNetwork
1. Deny-FileServices-InsecureAuth
1. Deny-FileServices-InsecureKerberos
1. Deny-FileServices-InsecureSmbChannel
1. Deny-FileServices-InsecureSmbVersions
1. Deny-MachineLearning-Aks
1. Deny-MachineLearning-Compute-SubnetId
1. Deny-MachineLearning-Compute-VmSize
1. Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess
1. Deny-MachineLearning-ComputeCluster-Scale
1. Deny-MachineLearning-HbiWorkspace
1. Deny-MachineLearning-PublicAccessWhenBehindVnet
1. Deny-MachineLearning-PublicNetworkAccess
1. Deny-MgmtPorts-From-Internet
1. Deny-Private-DNS-Zones
1. Deny-PublicEndpoint-MariaDB
1. Deny-PublicIP
1. Deny-RDP-From-Internet
1. Deny-Storage-SFTP
1. Deny-StorageAccount-CustomDomain
1. Deny-Subnet-Without-Nsg
1. Deny-Subnet-Without-Penp
1. Deny-Subnet-Without-Udr
1. Deny-UDR-With-Specific-NextHop
1. Deny-VNET-Peering-To-Non-Approved-VNETs
1. Deny-VNet-Peering
1. Deploy-Budget
1. Deploy-Custom-Route-Table
1. Deploy-DDoSProtection
1. Deploy-FirewallPolicy
1. Deploy-Nsg-FlowLogs
1. Deploy-Nsg-FlowLogs-to-LA
1. Deploy-Sql-Tde
1. Deploy-Sql-vulnerabilityAssessments_20230706
1. Deploy-VNET-HubSpoke
1. Deploy-Windows-DomainJoin

### Custom policies referenced in a policy set

81 custom policies are referenced from a policy set:

1. Append-AppService-httpsonly
1. Append-AppService-latestTLS
1. Append-Redis-disableNonSslPort
1. Append-Redis-sslEnforcement
1. Audit-AzureHybridBenefit
1. Audit-Disks-UnusedResourcesCostOptimization
1. Audit-PublicIpAddresses-UnusedResourcesCostOptimization
1. Audit-ServerFarms-UnusedResourcesCostOptimization
1. Deny-AppServiceApiApp-http
1. Deny-AppServiceFunctionApp-http
1. Deny-AppServiceWebApp-http
1. Deny-MySql-http
1. Deny-PostgreSql-http
1. Deny-Redis-http
1. Deny-Sql-minTLS
1. Deny-SqlMi-minTLS
1. Deny-Storage-minTLS
1. Deny-VNET-Peer-Cross-Sub
1. Deploy-ASC-SecurityContacts
1. Deploy-Diagnostics-AA
1. Deploy-Diagnostics-ACI
1. Deploy-Diagnostics-ACR
1. Deploy-Diagnostics-APIMgmt
1. Deploy-Diagnostics-AVDScalingPlans
1. Deploy-Diagnostics-AnalysisService
1. Deploy-Diagnostics-ApiForFHIR
1. Deploy-Diagnostics-ApplicationGateway
1. Deploy-Diagnostics-Bastion
1. Deploy-Diagnostics-CDNEndpoints
1. Deploy-Diagnostics-CognitiveServices
1. Deploy-Diagnostics-CosmosDB
1. Deploy-Diagnostics-DLAnalytics
1. Deploy-Diagnostics-DataExplorerCluster
1. Deploy-Diagnostics-DataFactory
1. Deploy-Diagnostics-Databricks
1. Deploy-Diagnostics-EventGridSub
1. Deploy-Diagnostics-EventGridSystemTopic
1. Deploy-Diagnostics-EventGridTopic
1. Deploy-Diagnostics-ExpressRoute
1. Deploy-Diagnostics-Firewall
1. Deploy-Diagnostics-FrontDoor
1. Deploy-Diagnostics-Function
1. Deploy-Diagnostics-HDInsight
1. Deploy-Diagnostics-LoadBalancer
1. Deploy-Diagnostics-LogAnalytics
1. Deploy-Diagnostics-LogicAppsISE
1. Deploy-Diagnostics-MariaDB
1. Deploy-Diagnostics-MediaService
1. Deploy-Diagnostics-MlWorkspace
1. Deploy-Diagnostics-MySQL
1. Deploy-Diagnostics-NIC
1. Deploy-Diagnostics-NetworkSecurityGroups
1. Deploy-Diagnostics-PostgreSQL
1. Deploy-Diagnostics-PowerBIEmbedded
1. Deploy-Diagnostics-RedisCache
1. Deploy-Diagnostics-Relay
1. Deploy-Diagnostics-SQLElasticPools
1. Deploy-Diagnostics-SQLMI
1. Deploy-Diagnostics-SignalR
1. Deploy-Diagnostics-TimeSeriesInsights
1. Deploy-Diagnostics-TrafficManager
1. Deploy-Diagnostics-VM
1. Deploy-Diagnostics-VMSS
1. Deploy-Diagnostics-VNetGW
1. Deploy-Diagnostics-VWanS2SVPNGW
1. Deploy-Diagnostics-VirtualNetwork
1. Deploy-Diagnostics-WVDAppGroup
1. Deploy-Diagnostics-WVDHostPools
1. Deploy-Diagnostics-WVDWorkspace
1. Deploy-Diagnostics-WebServerFarm
1. Deploy-Diagnostics-Website
1. Deploy-Diagnostics-iotHub
1. Deploy-MySQL-sslEnforcement
1. Deploy-PostgreSQL-sslEnforcement
1. Deploy-SQL-minTLS
1. Deploy-Sql-AuditingSettings
1. Deploy-Sql-SecurityAlertPolicies
1. Deploy-Sql-vulnerabilityAssessments
1. Deploy-SqlMi-minTLS
1. Deploy-Storage-sslEnforcement
1. Deploy-Vm-autoShutdown

### Built-in policies referenced in a policy set

125 built-in policies are referenced from at least one policy set:

1. 040732e8-d947-40b8-95d6-854c95024bf8
1. 04d53d87-841c-4f23-8a5b-21564380b55e
1. 051cba44-2429-45b9-9649-46cec11c7119
1. 06695360-db88-47f6-b976-7500d4297475
1. 08ba64b8-738f-4918-9686-730d2ed79c7d
1. 0961003e-5a0a-4549-abde-af6a37f2724d
1. 0a370ff3-6cab-4e85-8995-295fd854c5b8
1. 0b026355-49cb-467b-8ac4-f777874e175a
1. 0b60c0b2-2dc2-4e1c-b5c9-abbed971de53
1. 0fdf0491-d080-4575-b627-ad0e843cba0f
1. 12ef42cb-9903-4e39-9c26-422d29570417
1. 13ce0167-8ca6-4048-8e6b-f996402e3c1b
1. 152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0
1. 18adea5e-f416-4d0f-8aa8-d24321e3e274
1. 1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d
1. 1b5ef780-c53c-4a64-87f3-bb9c8c8094ba
1. 1b8ca024-1d5c-4dec-8995-b1a932b41780
1. 1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d
1. 1f6e93e8-6b31-41b1-83f6-36e449a42579
1. 1f725891-01c0-420a-9059-4fa46cb770b7
1. 1f905d99-2ab7-462c-a6b0-f709acca6c8f
1. 21a8cd35-125e-4d13-b82d-2e19b7208bb7
1. 2370a3c1-4a25-4283-a91a-c9c1a145fb2f
1. 237e0f7e-b0e8-4ec4-ad46-8c12cb66d673
1. 25a70cc8-2bd4-47f1-90b6-1478e4662c96
1. 2d048aca-6479-4923-88f5-e2ac295d9af3
1. 2fb86bf3-d221-43d1-96d1-2434af34eaa0
1. 331e8ea8-378a-410f-a2e5-ae22f38bb0da
1. 385f5831-96d4-41db-9a3c-cd3af78aaae6
1. 3cf2ab00-13f1-4d0c-8971-2ac904541a7e
1. 3d9f5e4c-9947-4579-9539-2a7695fbc187
1. 405c5871-3e91-4644-8a63-58e19d68ff5b
1. 437914ee-c176-4fff-8986-7e05eb971365
1. 438c38d2-3772-465a-a9cc-7a6666a275ce
1. 43d6e3bd-fc6a-4b44-8b4d-2151d8736a11
1. 44433aa3-7ec2-4002-93ea-65c65ff0310a
1. 470baccb-7e51-4549-8b1a-3e5be069f663
1. 4ec38ebc-381f-45ee-81a4-acbc4be878f8
1. 50ea7265-7d8c-429e-9a7d-ca1f410191c3
1. 55615ac9-af46-4a59-874e-391cc3dfb490
1. 59759c62-9a22-4cdf-ae64-074495983fef
1. 5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580
1. 5e1de0e3-42cb-4ebc-a86d-61d0c619ca48
1. 5e8168db-69e3-4beb-9822-57cb59202a9d
1. 5ff38825-c5d8-47c5-b70e-069a21955146
1. 64def556-fbad-4622-930e-72d1d5589bf5
1. 67121cc7-ff39-4ab8-b7e3-95b84dab487d
1. 689f7782-ef2c-4270-a6d0-7664869076bd
1. 6c112d4e-5bc7-47ae-a041-ea2d9dccd749
1. 6c66c325-74c8-42fd-a286-a74b0e2939d8
1. 6df98d03-368a-4438-8730-a93c4d7693d6
1. 6fac406b-40ca-413b-bf8e-0bf964659c25
1. 72650e9f-97bc-4b2a-ab5f-9781a9fcecbc
1. 74c30959-af11-47b3-9ed2-a26e03f427a3
1. 74c5a0ae-5e48-4738-b093-65e23a060488
1. 752154a7-1e0f-45c6-a880-ac75a7e4f648
1. 7590a335-57cf-4c95-babd-ecbc8fafeb1f
1. 75973700-529f-4de2-b794-fb9b6781b6b0
1. 797b37f7-06b8-444c-b1ad-fc62867f335a
1. 7a860e27-9ca2-4fc6-822d-c2d248c300df
1. 7bd000e3-37c7-4928-9f31-86c4b77c5c45
1. 7d7be79c-23ba-4033-84dd-45e2a5ccdd67
1. 82bf5b87-728b-4a74-ba4d-6123845cf542
1. 83c6fe0f-2316-444a-99a1-1ecd8a7872ca
1. 83cef61d-dbd1-4b20-a4fc-5fbc7da10833
1. 86a912f6-9a06-4e26-b447-11b16ba8659f
1. 86efb160-8de7-451d-bc08-5d475b0aadae
1. 87ba29ef-1ab3-4d82-b763-87fcd4f531f7
1. 8e86a5b6-b9bd-49d1-8e21-4bb8a0862222
1. 90bd4cb3-9f59-45f7-a6ca-f69db2726671
1. 942bd215-1a66-44be-af65-6a1c0318dbe2
1. 955a914f-bf86-4f0e-acd5-e0766b0efcb6
1. 969ac98b-88a8-449f-883c-2e9adb123127
1. 98728c90-32c7-4049-8429-847dc0f4fe37
1. 99e9ccd8-3db9-4592-b0d1-14b1715a4d8a
1. 9adab2a5-05ba-4fbd-831a-5bf958d04218
1. a08ec900-254a-4555-9bf5-e42af04b5c5c
1. a8eff44f-8c92-45c3-a3fb-9880802d67a7
1. aaa64d2d-2fa3-45e5-b332-0b031b9b30e8
1. ac673a9a-f77d-4846-b2d8-a57f8e1c01d4
1. b0e86710-7fb7-4a6c-a064-32e9b829509e
1. b0eb591a-5e70-4534-a8bf-04b9c489584a
1. b2982f36-99f2-4db5-8eff-283140c09693
1. b318f84a-b872-429b-ac6d-a01b96814452
1. b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d
1. b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb
1. b7021b2b-08fd-4dc0-9de7-3c6ece09faf9
1. b79fa14e-238a-4c2d-b376-442ce508fc84
1. b889a06c-ec72-4b03-910a-cb169ee18721
1. b99b73e7-074b-4089-9395-b7236f094491
1. ba769a63-b8cc-4b2d-abf6-ac33c7204be8
1. baf19753-7502-405f-8745-370519b20483
1. bc05b96c-0b36-4ca9-82f0-5c53f96ce05a
1. bcff79fb-2b0d-47c9-97e5-3023479b00d1
1. bef3f64c-5290-43b7-85b0-9b254eef4c47
1. c4bc6f10-cb41-49eb-b000-d5ab82e2a091
1. c717fb0c-d118-4c43-ab3d-ece30ac81fb3
1. c84e5349-db6d-4769-805e-e14037dab9b5
1. c9299215-ae47-4f50-9c54-8a392f68a052
1. c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02
1. c9ddb292-b203-4738-aead-18e2716e858f
1. d19ae5f1-b303-4b82-9ca8-7682749faf0c
1. d389df0a-e0d7-4607-833c-75a6fdac2c2d
1. d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03
1. d847d34b-9337-4e2d-99a5-767e5ac9c582
1. da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6
1. df73bd95-24da-4a4f-96b9-4e8b94b402bd
1. e016b22b-e0eb-436d-8fd7-160c4eaed6e2
1. e54d2be9-5f2e-4d65-98e4-4f0e670b23d6
1. e9585a95-5b8c-4d03-b193-dc7eb5ac4c32
1. ed66d4f5-8220-45dc-ab4a-20d1749c74e6
1. ee40564d-486e-4f68-a5ca-7a621edae0fb
1. f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b
1. f0fcf93c-c063-4071-9668-c47474bd3564
1. f7d52b2d-e161-4dfa-a82b-55e564167385
1. f9d614c5-c173-4d56-95a7-b4437057d193
1. fbc14a67-53e4-4932-abcc-2049c6706009
1. fc9b3da7-8347-4380-8e70-0a0361d8dedd
1. fdccbe47-f3e3-4213-ad5d-ea459b2fa077
1. ffb6f416-7bd2-4488-8828-56585fef2be9
1. 6dd01e4f-1be1-4e80-9d0b-d109e04cb064
1. 86cd96e1-1745-420d-94d4-d3f2fe415aa4
1. 1e5ed725-f16c-478b-bd4b-7bfa2f7940b9
1. b4a7f6c1-585e-4177-ad5b-c2c93f4bb991
1. a63cc0bd-cda4-4178-b705-37dc439d3e0f

### Built-in policies referenced from multiple policy sets

The following built-in policies are referenced from more than one policy set:

| Policy                               | Reference count |
|--------------------------------------|-----------------|
| 6dd01e4f-1be1-4e80-9d0b-d109e04cb064 | 2               |
| 86cd96e1-1745-420d-94d4-d3f2fe415aa4 | 2               |
| 1e5ed725-f16c-478b-bd4b-7bfa2f7940b9 | 3               |
| b4a7f6c1-585e-4177-ad5b-c2c93f4bb991 | 3               |
| a63cc0bd-cda4-4178-b705-37dc439d3e0f | 5               |
